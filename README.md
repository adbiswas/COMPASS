# Pocket Frequency Score
# Description
An innovative method for using resolved protein structures (similar structures) to find the best pockets and structures for large-scale virtual screening.
This approach is adopted for the input generated by the program FPocket.
In order to make it easier to modify inputs made by other programs, the code Pocket_Frequency_Algorithm.py is developed to facilitate the easy adaptation of inputs generated by other programs.
The code will be made available only on request.

# USAGE
Please follow the steps below for the usage of the Pocket Frequency Score:

a. With FPocket, create the pockets in the .xlxs format. Also, you have the option to choose the format, like.csv.

b. Organize the folders such that the pocket'X'.xlxs files are located according to their PDBIDs. Please note that the code is flexible and may be modified to separate the folders based on other criteria, however PDBIDs are encouraged.

c. The sixteen columns that should be present in the Pocket'X'.xlxs file are as follows: 'Number,' 'Atom,' 'Element,' 'Residue,' 'ResNum,' 'Chain,' 'X,' 'Y,' 'Z,' 'Charge,' 'Potential,' 'Constraint,' 'Score,' 'Consensus,' 'Pocket,' and 'Source.  This is the FPocket default output file; it may be used as an input file for the current code.

d. In the current directory, put the code for the Pocket_Frequency_Algorithm.py. Create a folder named "Pockets" in the current working directory. Inside, you should see subdirectories labeled with the names of the various systems. The Pocket'X'.xlxs files with the system's pocket information are located inside each system.

e. On the eleventh line of the code for the Pocket Frequency Algorithm, change the path of the directory 'Pockets' to 'INPUT_YOUR_PATH_OF_THE_DIRECTORY_WHERE_YOU_HAVE_THE_POCKETS'.

f. When the program runs without error. For the purpose of checking different phases, it will generate several output files that may be examined. We will name the primary output file SPDP-Score.csv.

g. Pocket-Source, Frequency, Score, and Consensus are the four columns that make up the SPDP-Score.

h. Pocket-Source gives the name of the PDB ID and the pocket details, the next column Frequency Score gives the total frequency of that pocket.


# Algorithm
Input: Directory containing pocket files  
Output: Categorized pocket matches and similarity scores  

1. Initialize empty data structures for residue and similarity data.  

2. For each file in the directory:  
   a. Read the file and add metadata (Pocket and Source identifiers).  
   b. Filter rows for C-alpha atoms and extract residue information.  
   c. Format and append residue and pocket data to the main dataset. 
 
3. Compare residues to identify similar pockets across chains.  

4. Save residue similarity data to an intermediate file.  

5. Remove duplicate pocket IDs and generate unique matches.  

6. Categorize pockets into:  
   a. Similar pockets in the same protein.  
   b. Similar pockets in different proteins.  

7. Remove duplicate entries from each category.  

8. Compute and score redundancy-free pocket matches.  

9. Save categorized matches and scores to output files.

# Profiling of Interactions
The folder called 'Interaction Profile' has the 3D structures of the pockets reveal eight different ligand-protein interactions.
This is the.mol2 format for the protein-ligand complexes. The figures also display the interaction profiles.
The structures were located in the lowest energy basin of the different Free Energy Landscapes and were retrieved after running Essential Dynamics on the MD simulation trajectories.

# Further Assistance for Reproducibility
If you need any more help with successfully implementing the code, please don't hesitate to contact the author at akashdeep.biswas@dompe.com
